<h1>The Ruby Ecosystem</h1>
<h3>as of <%= (Date.today - 60.day).to_s(:long) %></h3>

<% @charts.each do | name, path | %>
  <p><%= h name %></p>
  <%= content_tag :div, class: "#{path.parameterize}-graph-ranges" do %>
    <%= link_to "YTD", "#{path}?range=1year", remote: true %>
    <%= link_to "3m", "#{path}?range=3months", remote: true %>
    <%= link_to "1m", "#{path}?range=1month", remote: true %>
    <%= link_to "2w", "#{path}?range=2weeks", remote: true %>
  <% end %>

  <%= content_tag :div, id: "#{path.parameterize}-graph" do %>
  <% end %>
<% end %>

<%= content_tag :div, class: "ruby-total-ranges" do %>
  <%= link_to "YTD", "/versions/ruby?total=true&range=1year", remote: true %>
  <%= link_to "3m", "/versions/ruby?total=true&range=3months", remote: true %>
  <%= link_to "1m", "/versions/ruby?total=true&range=1month", remote: true %>
  <%= link_to "2w", "/versions/ruby?total=true&range=2weeks", remote: true %>
<%end %>

<%= content_tag :div, id: "ruby-total" do %>
<% end %>

<script>
  <% @charts.each do |name, path| %>
      <%= render partial: "chart", locals: {path: path}, handlers: [:erb], formats: [:js] %>
  <% end %>
  <%= render partial: "totals", locals: {key: "ruby"}, handlers: [:erb], formats: [:js] %>
</script>
